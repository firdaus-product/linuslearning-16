<!DOCTYPE html>
<html lang="ms-MY">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Kemahiran Pemulihan: Kurang Satu & Beza Nombor (Pembelajaran)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body{box-sizing:border-box}
    .activity-card{min-height:400px}
    .number-card{transition:all .3s ease}
    .number-card:hover{transform:scale(1.05)}
    .selected{background-color:#fbbf24!important;transform:scale(1.1)}
    .dragging{opacity:.5;transform:rotate(5deg)}
    .drop-zone{border:3px dashed #d1d5db;transition:all .3s ease}
    .drop-zone.drag-over{border-color:#3b82f6;background-color:#dbeafe}
    .fruit-item{cursor:pointer;transition:all .3s ease}
    .fruit-item:hover{transform:scale(1.1)}
    .crossed-out{opacity:.35;filter:grayscale(0.5)}
    .fact-card{transition:all .25s ease}
    .fact-card:hover{transform:scale(1.03)}
  </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-purple-50 min-h-full">

  <!-- Info Bar -->
  <div class="bg-yellow-400 p-4 shadow-lg">
    <div class="max-w-6xl mx-auto flex items-center justify-between">
      <div class="flex items-center gap-4">
        <span class="text-3xl">üìö</span>
        <div>
          <h1 class="text-xl font-bold text-gray-900">Kemahiran Pemulihan: Kurang Satu & Beza Nombor</h1>
          <p id="info-text" class="text-lg text-gray-800">Klik mana-mana elemen untuk belajar.</p>
        </div>
      </div>
      <button id="speak-btn" class="bg-white hover:bg-gray-100 text-gray-800 font-bold py-3 px-6 rounded-full shadow-lg text-2xl transition-all duration-200 hover:scale-105">üîä</button>
    </div>
  </div>

  <div class="max-w-6xl mx-auto p-6">
    <!-- Activity Card -->
    <div class="bg-white rounded-xl shadow-lg p-8 mb-6 activity-card">
      <div id="activity-content">
        <div class="text-center py-20">
          <span class="text-6xl mb-4 block">üéØ</span>
          <h2 class="text-2xl font-bold text-gray-700 mb-4">Pilih Aktiviti untuk Mula Belajar</h2>
          <p class="text-lg text-gray-500">Klik butang aktiviti di bawah untuk bermula!</p>
        </div>
      </div>
    </div>

    <!-- Activity Buttons (nama pendek) -->
    <div class="grid grid-cols-2 md:grid-cols-5 gap-4">
      <button onclick="startActivity(1)" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-4 px-6 rounded-lg shadow-lg transition-all hover:scale-105 text-lg">
        <div class="text-2xl mb-1">üîπ</div> Kurang 1
      </button>
      <button onclick="startActivity(2)" class="bg-green-500 hover:bg-green-600 text-white font-bold py-4 px-6 rounded-lg shadow-lg transition-all hover:scale-105 text-lg">
        <div class="text-2xl mb-1">üéØ</div> Beza
      </button>
      <button onclick="startActivity(3)" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-4 px-6 rounded-lg shadow-lg transition-all hover:scale-105 text-lg">
        <div class="text-2xl mb-1">üßÆ</div> Susun
      </button>
      <button onclick="startActivity(4)" class="bg-pink-500 hover:bg-pink-600 text-white font-bold py-4 px-6 rounded-lg shadow-lg transition-all hover:scale-105 text-lg">
        <div class="text-2xl mb-1">üçé</div> Buah Tolak
      </button>
      <button onclick="startActivity(5)" class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-4 px-6 rounded-lg shadow-lg transition-all hover:scale-105 text-lg">
        <div class="text-2xl mb-1">üìò</div> Fakta 5
      </button>
    </div>

    <!-- Controls -->
    <div class="flex justify-center gap-4 mt-6">
      <button onclick="clearActivity()" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-lg shadow">üßπ Bersih</button>
      <button onclick="nextActivity()" class="bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg shadow">‚û°Ô∏è Seterusnya</button>
    </div>
  </div>

  <script>
    let currentActivity = 0;
    let isUnlocked = false;

    // TTS
    function unlockAudio(){ if(!isUnlocked){ speechSynthesis.speak(new SpeechSynthesisUtterance('')); isUnlocked=true; } }
    function setInfo(t){ document.getElementById('info-text').textContent=t; }
    function speak(t){
      if(!isUnlocked) return;
      speechSynthesis.cancel();
      setTimeout(()=>{
        const u=new SpeechSynthesisUtterance(t);
        u.lang='ms-MY'; u.rate=.85; u.pitch=1.05;
        const v=speechSynthesis.getVoices().find(v=>v.lang.includes('ms')||v.lang.includes('MY'));
        if(v) u.voice=v;
        speechSynthesis.speak(u);
      },80);
    }
    document.getElementById('speak-btn').addEventListener('click',()=>{unlockAudio();speak(document.getElementById('info-text').textContent);});
    document.addEventListener('click',unlockAudio,{once:true});

    function clearActivity(){
      currentActivity=0;
      document.getElementById('activity-content').innerHTML = `
        <div class="text-center py-20">
          <span class="text-6xl mb-4 block">üéØ</span>
          <h2 class="text-2xl font-bold text-gray-700 mb-4">Pilih Aktiviti untuk Mula Belajar</h2>
          <p class="text-lg text-gray-500">Klik butang aktiviti di bawah untuk bermula!</p>
        </div>`;
      setInfo('Klik mana-mana elemen untuk belajar.');
    }
    function nextActivity(){ currentActivity = (currentActivity%5)+1; startActivity(currentActivity); }
    function startActivity(n){
      currentActivity=n;
      if(n===1) activity1_NumberLine();
      if(n===2) activity2_Difference();
      if(n===3) activity3_SortExplore();
      if(n===4) activity4_FruitSubtract();
      if(n===5) activity5_FactsFive();
    }

    /* ========= Aktiviti 1: Kurang 1 (eksplorasi) ========= */
    function activity1_NumberLine(){
      setInfo('Klik mana-mana nombor untuk dengar dan lihat ‚Äúkurang satu daripada‚Äù.');
      document.getElementById('activity-content').innerHTML = `
        <div class="text-center mb-6">
          <h2 class="text-3xl font-bold text-blue-600 mb-2">üîπ Kurang Satu Daripada Nombor</h2>
          <p class="text-lg text-gray-600">Pilih nombor; paparan akan menerangkan tanpa menilai.</p>
        </div>
        <div class="grid grid-cols-5 gap-4 max-w-4xl mx-auto mb-6">
          ${Array.from({length:15},(_,i)=>i+1).map(n=>`
            <div class="number-card bg-blue-100 hover:bg-blue-200 p-6 rounded-xl text-center cursor-pointer shadow" onclick="showLessOne(${n})">
              <div class="text-4xl font-bold text-blue-800">${n}</div>
            </div>`).join('')}
        </div>
        <div id="result-area" class="text-center p-8 bg-yellow-50 rounded-xl">
          <p class="text-xl text-gray-700">Pilih nombor di atas untuk melihat penerangan.</p>
        </div>`;
    }
    function showLessOne(n){
      const r=n-1, txt=r>=0?r:'tiada';
      document.getElementById('result-area').innerHTML = `
        <div class="text-center">
          <p class="text-2xl text-gray-700 mb-2">Kurang satu daripada <span class="font-bold text-blue-600">${n}</span> ialah</p>
          <div class="text-6xl font-bold text-green-600 mb-2">${txt}</div>
          <p class="text-lg text-gray-600">${n} ‚àí 1 = ${txt}</p>
        </div>`;
      setInfo(`Kurang satu daripada ${n} ialah ${txt}.`);
      speak(`Kurang satu daripada ${n} ialah ${txt}.`);
    }

    /* ========= Aktiviti 2: Beza (eksplorasi, tiada betul/salah) ========= */
    function activity2_Difference(){
      setInfo('Klik dua nombor untuk meneroka beza antara keduanya.');
      const nums=[3,7,5,9,2,8,4,6]; let chosen=[];
      document.getElementById('activity-content').innerHTML = `
        <div class="text-center mb-6">
          <h2 class="text-3xl font-bold text-green-600 mb-2">üéØ Beza Antara Dua Nombor</h2>
          <p class="text-lg text-gray-600">Tiada penilaian ‚Äî hanya penerangan.</p>
        </div>
        <div class="grid grid-cols-4 gap-6 max-w-3xl mx-auto mb-6">
          ${nums.map(n=>`
            <div class="number-card bg-green-100 hover:bg-green-200 p-8 rounded-xl text-center cursor-pointer shadow" onclick="pickDiff(${n}, this)">
              <div class="text-5xl font-bold text-green-800">${n}</div>
            </div>`).join('')}
        </div>
        <div id="selection-area" class="text-center p-8 bg-blue-50 rounded-xl">
          <p class="text-xl text-gray-700">Pilih dua nombor untuk melihat beza.</p>
        </div>`;
      window.pickDiff=function(n,el){
        if(chosen.length<2 && !chosen.includes(n)){
          chosen.push(n); el.classList.add('selected');
          if(chosen.length===1){
            document.getElementById('selection-area').innerHTML = `<p class="text-xl text-gray-700">Nombor pertama: <span class="font-bold text-blue-600">${n}</span>. Pilih nombor kedua.</p>`;
          }else{
            const big=Math.max(...chosen), small=Math.min(...chosen), diff=big-small;
            document.getElementById('selection-area').innerHTML = `
              <div class="text-center">
                <p class="text-xl text-gray-700 mb-2">Beza di antara <span class="font-bold text-blue-600">${chosen[0]}</span> dan <span class="font-bold text-blue-600">${chosen[1]}</span> ialah</p>
                <div class="text-6xl font-bold text-purple-600 mb-2">${diff}</div>
                <p class="text-lg text-gray-600">${big} ‚àí ${small} = ${diff}</p>
                <button onclick="resetDiff()" class="mt-3 bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-lg">Cuba Lagi</button>
              </div>`;
            setInfo(`Beza antara ${chosen[0]} dan ${chosen[1]} ialah ${diff}.`);
            speak(`Beza antara ${chosen[0]} dan ${chosen[1]} ialah ${diff}.`);
          }
        }
      }
      window.resetDiff=function(){
        chosen=[]; document.querySelectorAll('.number-card').forEach(c=>c.classList.remove('selected'));
        document.getElementById('selection-area').innerHTML = `<p class="text-xl text-gray-700">Pilih dua nombor untuk melihat beza.</p>`;
        setInfo('Klik dua nombor untuk meneroka beza.');
      }
    }

    /* ========= Aktiviti 3: Susun (penerokaan ‚Äî paparkan susunan pengguna & cadangan) ========= */
    function activity3_SortExplore(){
      setInfo('Seret nombor mengikut pilihan anda. Bila lengkap, sistem memaparkan urutan meningkat sebagai rujukan.');
      const pool=[8,3,6,1,9,4]; let placed=new Array(pool.length).fill(null);
      document.getElementById('activity-content').innerHTML = `
        <div class="text-center mb-6">
          <h2 class="text-3xl font-bold text-purple-600 mb-2">üßÆ Susun Nombor (Teroka)</h2>
          <p class="text-lg text-gray-600">Tiada betul/salah ‚Äî hanya bandingkan dengan cadangan urutan meningkat.</p>
        </div>
        <div class="mb-6">
          <h3 class="text-xl font-bold text-center text-gray-700 mb-3">Nombor untuk diteroka:</h3>
          <div class="flex flex-wrap justify-center gap-3 mb-6">
            ${pool.map(n=>`
              <div class="number-card bg-yellow-200 p-4 rounded-lg text-center cursor-move shadow"
                   draggable="true" ondragstart="dragStart(event, ${n})">
                <div class="text-3xl font-bold text-yellow-800">${n}</div>
              </div>`).join('')}
          </div>
        </div>
        <div class="mb-6">
          <h3 class="text-xl font-bold text-center text-gray-700 mb-3">Letak di sini (ikut pilihan anda):</h3>
          <div class="flex justify-center gap-3">
            ${Array.from({length:pool.length},(_,i)=>`
              <div class="drop-zone w-20 h-20 rounded-lg flex items-center justify-center text-2xl font-bold"
                   ondrop="dropHere(event, ${i})" ondragover="allowDrop(event)" ondragenter="dragEnter(event)" ondragleave="dragLeave(event)">
                ${i+1}
              </div>`).join('')}
          </div>
        </div>
        <div id="sort-result" class="text-center p-6 bg-green-50 rounded-xl">
          <p class="text-lg text-gray-700">Letakkan semua nombor ‚Äî kemudian lihat perbandingan.</p>
        </div>
        <div class="text-center mt-4">
          <button onclick="startActivity(3)" class="bg-gray-500 hover:bg-gray-600 text-white px-5 py-2 rounded-lg font-bold">Mula Semula</button>
        </div>`;
      window.dragStart=(e,n)=>{e.dataTransfer.setData('text/plain',n); e.target.classList.add('dragging');}
      window.allowDrop=e=>e.preventDefault();
      window.dragEnter=e=>e.target.classList.add('drag-over');
      window.dragLeave=e=>e.target.classList.remove('drag-over');
      window.dropHere=(e,pos)=>{
        e.preventDefault(); const n=parseInt(e.dataTransfer.getData('text/plain')); e.target.classList.remove('drag-over');
        placed[pos]=n; e.target.innerHTML=`<div class="text-2xl font-bold text-purple-700">${n}</div>`; e.target.classList.add('bg-purple-100');
        document.querySelectorAll('.number-card').forEach(c=>{ if(c.textContent.trim()==n.toString()) c.style.display='none';});
        if(placed.every(x=>x!==null)){
          const cadangan=[...pool].sort((a,b)=>a-b);
          document.getElementById('sort-result').innerHTML = `
            <div class="text-center">
              <p class="text-xl text-gray-700 mb-2">Susunan anda: <span class="font-bold text-purple-700">${placed.join(', ')}</span></p>
              <p class="text-xl text-gray-700">Cadangan urutan meningkat: <span class="font-bold text-green-700">${cadangan.join(', ')}</span></p>
              <p class="mt-2 text-gray-600">Perhatikan beza kedua-dua susunan. Boleh mula semula untuk cuba susunan lain.</p>
            </div>`;
          speak('Ini susunan anda dan cadangan urutan meningkat. Bandingkan perbezaannya.');
        }
      }
    }

    /* ========= Aktiviti 4: Buah Tolak (eksplorasi) ========= */
    function activity4_FruitSubtract(){
      setInfo('Klik buah untuk ‚Äúdimakan‚Äù dan lihat berapa yang tinggal.');
      const scenarios=[
        {total:5,toRemove:2,fruit:'üçé',name:'epal'},
        {total:7,toRemove:3,fruit:'üçå',name:'pisang'},
        {total:6,toRemove:4,fruit:'üçä',name:'oren'}
      ];
      let i=0, removed=0;
      const show=()=>{
        removed=0;
        const s=scenarios[i];
        document.getElementById('activity-content').innerHTML = `
          <div class="text-center mb-6">
            <h2 class="text-3xl font-bold text-pink-600 mb-2">üçé Tolak dengan Buah-buahan</h2>
            <p class="text-lg text-gray-700">Ada ${s.total} ${s.name}. Klik ${s.toRemove} ${s.name} untuk menandakan ia ‚Äúdiambil‚Äù.</p>
          </div>
          <div class="grid grid-cols-4 gap-6 max-w-2xl mx-auto mb-6">
            ${Array.from({length:s.total},(_,k)=>`
              <div class="fruit-item text-6xl text-center p-4 rounded-xl bg-pink-50 hover:bg-pink-100" onclick="eatFruit(this)">
                ${s.fruit}
              </div>`).join('')}
          </div>
          <div id="fruit-result" class="text-center p-6 bg-orange-50 rounded-xl">
            <p class="text-xl text-gray-700">Klik ${s.toRemove} ${s.name} untuk melihat tinggal berapa.</p>
          </div>
          <div class="text-center mt-4">
            <button onclick="nextScenario()" class="bg-pink-500 hover:bg-pink-600 text-white font-bold py-2 px-6 rounded-lg mr-2">Seterusnya</button>
            <button onclick="show()" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-6 rounded-lg">Mula Semula</button>
          </div>`;
      }
      window.eatFruit=function(el){
        const s=scenarios[i];
        if(el.classList.contains('crossed-out')) return;
        if(removed>=s.toRemove) return;
        el.classList.add('crossed-out'); removed++;
        const remain=s.total-removed;
        if(removed===s.toRemove){
          document.getElementById('fruit-result').innerHTML = `
            <div class="text-center">
              <p class="text-2xl text-gray-700 mb-2">${s.total} ${s.name} ‚àí ${s.toRemove} ${s.name}</p>
              <div class="text-6xl font-bold text-green-600 mb-2">${remain}</div>
              <p class="text-lg text-gray-700">Tinggal ${remain} ${s.name}.</p>
            </div>`;
          speak(`${s.total} ${s.name} tolak ${s.toRemove} ${s.name} menjadi ${remain}.`);
        }else{
          document.getElementById('fruit-result').innerHTML = `<p class="text-xl text-gray-700">Tandakan ${s.toRemove-removed} lagi ${s.name}.</p>`;
        }
      }
      window.nextScenario=function(){ i=(i+1)%scenarios.length; show(); }
      show();
    }

    /* ========= Aktiviti 5: Fakta 5 (galeri, tiada pemadanan/penilaian) ========= */
    function activity5_FactsFive() {
      // papar UI galeri
      document.getElementById('activity-content').innerHTML = `
        <div class="text-center mb-6">
          <h2 class="text-3xl font-bold text-amber-700">üìò Galeri Fakta: Hasil 5</h2>
          <p class="text-gray-600">Setiap kad menerangkan ayat tolak yang memberi jawapan 5.</p>
        </div>

        <div id="facts-wrap" class="grid md:grid-cols-3 gap-4 mb-6"></div>

        <div class="bg-white rounded-xl shadow p-6">
          <div id="fact-result" class="text-center text-gray-600">
            <p>Pilih mana-mana kad di atas untuk melihat penerangan.</p>
          </div>
        </div>
      `;

      // data fakta
      const facts = [
        { left: 10, right: 5, icon: 'üç™' },
        { left: 9,  right: 4, icon: 'üêû' },
        { left: 8,  right: 3, icon: '‚≠êÔ∏è' },
        { left: 7,  right: 2, icon: 'üéà' },
        { left: 6,  right: 1, icon: 'üß©' },
      ];

      // bina kad
      const wrap = document.getElementById('facts-wrap');
      wrap.innerHTML = facts.map((f, i) => `
        <button
          class="w-full text-left bg-amber-50 hover:bg-amber-100 border border-amber-200 rounded-xl p-5 transition"
          onclick="showFact(${i})"
        >
          <div class="text-4xl mb-2">${f.icon}</div>
          <div class="text-2xl font-extrabold text-amber-800">
            ${f.left} ‚àí ${f.right} = 5
          </div>
          <div class="text-sm text-gray-500 mt-1">Klik untuk lihat penerangan.</div>
        </button>
      `).join('');

      setInfo('Klik mana-mana kad untuk dengar dan lihat penerangan ayat tolak yang menghasilkan 5.');

      // fungsi global untuk klik kad (DIKEMAS KINI sebutan)
      window.showFact = function(i) {
        const f = facts[i];
        const remain = f.left - f.right;   // akan sentiasa 5 di galeri ini
        const spoken = `${f.left} tolak ${f.right}`;

        // info bar + TTS (DIKEMAS KINI)
        setInfo(`${spoken} menghasilkan 5. Inilah salah satu cara mendapat 5 melalui operasi tolak.`);
        speak(`${spoken} menghasilkan ${remain}.`);

        // render panel hasil
        const stars = '‚≠êÔ∏è'.repeat(f.left);
        document.getElementById('fact-result').innerHTML = `
          <div class="text-3xl mb-3">${stars}</div>
          <div class="text-2xl font-bold text-gray-800 mb-1">${f.left} ‚àí ${f.right}</div>
          <div class="text-6xl font-extrabold text-green-600 leading-none mb-2">5</div>
          <p class="text-gray-600">Daripada ${f.left} objek, ambil ${f.right}. Tinggal ${remain}.</p>
        `;
      };
    }

    // Init
    window.addEventListener('load',()=>setInfo('Klik mana-mana elemen untuk belajar.'));
  </script>

</body>
</html>
